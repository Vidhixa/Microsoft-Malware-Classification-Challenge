

import java.sql.*;
import java.util.ArrayList;
import java.util.List;

public class MysqlConnector {

	Connection con = null;
    Statement st = null;
    ResultSet rs = null;
    String url = "", user = "",passwd = "";
    
	public MysqlConnector(){
		
		url = "jdbc:mysql://localhost:57698/kaggle";
		user = "root";
		passwd = "";
	}
	
	public void connect() throws SQLException{
		con = DriverManager.getConnection(url,user,passwd);
	}
	
	public List<String> getData(int classLabel) throws SQLException {
				
		List<String> rsList = new ArrayList<String>();
		String query;
		query = String.format("SELECT filename FROM Class WHERE classLabel = %d",classLabel);
		st = con.createStatement();
		rs = st.executeQuery(query);
		String temp;
		while(rs.next()) {
			temp = rs.getString(1);
			temp = temp.replace("\"", "");
			rsList.add(temp);
		}
		return rsList;
	}	
	
	public void disconnect() throws SQLException{
		con.close();
	}
}
